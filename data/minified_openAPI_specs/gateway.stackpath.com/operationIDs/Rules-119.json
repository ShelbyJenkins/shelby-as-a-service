{"metadata": {"tag": "Rules", "tag_number": 0, "doc_number": 119, "operation_id": "getrules", "doc_url": "https://stackpath.dev/reference/getrules", "server_url": "https://gateway.stackpath.com/waf/v1/stacks/{stack_id}/sites/{site_id}/rules"}, "content": "path /waf/v1/stacks/stackid/sites/siteid/rules\noperationId GetRules\nparameters\nname stackid\ndescription A stack ID or slug\nin path\nrequired True\nschema\ntype string\nname siteid\ndescription A site ID\nin path\nrequired True\nschema\ntype string\nname pagerequestfirst\ndescription The number of items desired\nin query\nrequired False\nschema\ntype string\nname pagerequestafter\ndescription The cursor value after which data will be returned\nin query\nrequired False\nschema\ntype string\nname pagerequestfilter\ndescription SQLstyle constraint filters\nin query\nrequired False\nschema\ntype string\nname pagerequestsortby\ndescription Sort the response by the given field\nin query\nrequired False\nschema\ntype string\nsummary Get all rules\nresponses\n200\nwafGetRulesResponse\ntype object\nproperties\npaginationPageInfo\ntype object\nproperties\ntotalCount\ntype string\ndescription The total number of items in the dataset\nhasPreviousPage\ntype boolean\nformat boolean\ndescription Whether or not a previous page of data exists\nhasNextPage\ntype boolean\nformat boolean\ndescription Whether or not another page of data is available\nstartCursor\ntype string\ndescription The cursor for the first item in the set of data returned\nendCursor\ntype string\ndescription The cursor for the last item in the set of data returned\ndescription Information about a paginated response\n\nThis is modeled after the GraphQL Relay spec to support both cursor based pagination and traditional offset based pagination\nrules\ntype array\nwafRule\ntype object\nproperties\nid\ntype string\ndescription A rules ID\nname\ntype string\ndescription A rules name\ndescription\ntype string\ndescription A rules description\nconditions\ntype array\nRuleCondition\ntype object\nproperties\nConditionIpCondition\ntype object\nipAddress\ntype string\ndescription A single IPv4 address\ndescription Match the incoming request against a single IP address\nConditionIpRangeCondition\ntype object\nproperties\nlowerBound\ntype string\ndescription The lower bound IPv4 address to match against\nupperBound\ntype string\ndescription The upper bound IPv4 address to match against\ndescription Match the incoming request against a range of IPv4 addresses\nConditionUrlCondition\ntype object\nproperties\nurl\ntype string\ndescription The URL path to match\n\nURL paths may only contain the characters AZ az 09    #          /\nexactMatch\ntype boolean\nformat boolean\ndescription Whether to perform an exact match or a string contains match of the URL\ndescription Match the incoming request URL path\nConditionUserAgentCondition\ntype object\nproperties\nuserAgent\ntype string\ndescription The user agent value to match\nexactMatch\ntype boolean\nformat boolean\ndescription Whether to perform an exact match or a string contains match of the user agent\ndescription Match the user agent making the request\nConditionHeaderCondition\ntype object\nproperties\nheader\ntype string\ndescription The request header name\nvalue\ntype string\ndescription The request header value\nexactMatch\ntype boolean\nformat boolean\ndescription Whether or not to perform an exact match of the request header and value\ndescription Match an incoming request header\nConditionHeaderExistsCondition\ntype object\nheader\ntype string\ndescription The request header name\ndescription Match when an incoming request header is present\nConditionResponseHeaderCondition\ntype object\nproperties\nheader\ntype string\ndescription The response header name\nvalue\ntype string\ndescription The response header value\nexactMatch\ntype boolean\nformat boolean\ndescription Whether to perform an exact match of the response header and value\ndescription Match a response header\nConditionResponseHeaderExistsCondition\ntype object\nheader\ntype string\ndescription The response header name\ndescription Match when a response header is present\nConditionHttpMethodCondition\ntype object\nwafHttpMethod\ntype string\ndefault METHODUNSPECIFIED\ndescription HTTP methods of a request\n\n METHODUNSPECIFIED Unspecified HTTP method\n  GET HTTP GET method\n  POST HTTP POST method\n  PUT HTTP PUT method\n  DELETE HTTP DELETE method\n  HEAD HTTP HEAD method\n  PATCH HTTP PATCH method\n  OPTIONS HTTP OPTIONS method\n  CONNECT HTTP CONNECT method\n  TRACE HTTP TRACE method\ndescription Match the incoming HTTP method\nConditionFileExtensionCondition\ntype object\nfileExtension\ntype string\ndescription The file extension to match\n\nThis must be an optional period followed by a series of caseinsensitive alphanumeric characters\ndescription Match the incoming file extension\nConditionContentTypeCondition\ntype object\ncontentType\ntype string\ndescription The ContentType to match against\n\nThis must be groupings of AZ az 09  characters separated by a single slash\ndescription Match the requested ContentType\nConditionCountryCondition\ntype object\ncountryCode\ntype string\ndescription An ISO 31661 alpha2 formatted string\ndescription Match the country that the requested originated from\nConditionOrganizationCondition\ntype object\norganization\ntype string\ndescription The organization to match against\ndescription Match the organization the request originated from as determined by a WHOIS lookup of the requesting IP\nConditionRequestRateCondition\ntype object\nproperties\nips\ntype string\ndescription A list of source IPs that can trigger a request rate condition\nhttpMethods\ntype array\nwafHttpMethod\ntype string\ndefault METHODUNSPECIFIED\ndescription HTTP methods of a request\n\n METHODUNSPECIFIED Unspecified HTTP method\n  GET HTTP GET method\n  POST HTTP POST method\n  PUT HTTP PUT method\n  DELETE HTTP DELETE method\n  HEAD HTTP HEAD method\n  PATCH HTTP PATCH method\n  OPTIONS HTTP OPTIONS method\n  CONNECT HTTP CONNECT method\n  TRACE HTTP TRACE method\ndescription Possible HTTP request methods that can trigger a request rate condition\npathPattern\ntype string\ndescription A regular expression matching the URL path of the incoming request\nrequests\ntype string\ndescription The number of incoming requests over the given time that can trigger a request rate condition\n\nThis must be an integer greater than 20\ntime\ntype string\ndescription The number of seconds that the WAF measures incoming requests over before triggering a request rate condition\ndescription Match the rate at which requests come in that match certain conditions\nConditionOwnerTypeCondition\ntype object\nownerTypes\ntype array\nOwnerTypeConditionOwnerType\ntype string\ndefault COMMERCIAL\ndescription Potential source IP owner types to match against\ndescription The owner value to match against\ndescription Match the type of organization that owns the IP address making an incoming request\nConditionTagCondition\ntype object\ntags\ntype string\ndescription A facet of the incoming request to match against\ndescription Match aspects of an incoming request\nConditionSessionRequestCountCondition\ntype object\nrequestCount\ntype string\ndescription The number of dynamic requests in the session\n\nThis must be a value greater than zero\ndescription Match the number of dynamic page requests made in a WAF session\n\nThe WAF injects a session cookie into protected pages to track multirequest security issues This condition matches against the number of dynamic page requests made during that sessions lifetime\nnegation\ntype boolean\nformat boolean\ndescription Whether or not to apply a boolean NOT operation to the rules condition\ndescription The conditions required for the WAF engine to trigger the rule\n\nRules may have between 1 and 5 conditions All conditions must pass for the rule to trigger\nwafRuleAction\ntype string\ndefault BLOCK\ndescription The actions that the WAF takes when a rule is triggered\n\n BLOCK The WAF blocked the request\n  ALLOW The WAF allowed the request\n  CAPTCHA The WAF presented the user with a captcha\n  HANDSHAKE The WAF performed automatic browser validation\n  MONITOR The WAF monitored the request but took no action\n  GATEWAY The WAF performed extended automatic browser validation\nenabled\ntype boolean\nformat boolean\ndescription Whether or not a WAF rule is enabled\nactionDuration\ntype string\ndescription How long a rules block action will apply to subsequent requests\n\nDurations only apply to rules with block actions\nwafRuleStatusCode\ntype string\ndefault FORBIDDEN403\ndescription A custom HTTP status code that the WAF returns if a rule blocks a request\ndescription A custom WAF rule applied to a site\n\nUnlike predefined policies rules are provided by the user for custom WAF functionality\ndescription The requested WAF rules\ndescription The results from a request to retrieve a sites WAF rules"}