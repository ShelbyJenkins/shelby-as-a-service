{"openapi":"3.0.0","info":{"title":"Web Application Firewall","version":"1.0.0","contact":{"name":"StackPath Support","url":"https://support.stackpath.com/"}},"paths":{"/waf/v1/organizations":{"get":{"summary":"Get WHOIS organizations","description":"StackPath regularly searches IP address space for organizations to allow or block in custom rules.","operationId":"GetWAFOrganizations","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetWAFOrganizationsResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"page_request.first","description":"The number of items desired.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.after","description":"The cursor value after which data will be returned.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.filter","description":"SQL-style constraint filters.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.sort_by","description":"Sort the response by the given field.","in":"query","required":false,"schema":{"type":"string"}}],"tags":["Infrastructure"]}},"/waf/v1/stacks/{stack_id}/delivery/certificates":{"get":{"summary":"Get all certificates","operationId":"GetCertificates","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetCertificatesResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"page_request.first","description":"The number of items desired.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.after","description":"The cursor value after which data will be returned.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.filter","description":"SQL-style constraint filters.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.sort_by","description":"Sort the response by the given field.","in":"query","required":false,"schema":{"type":"string"}}],"tags":["SSL"]},"post":{"summary":"Add a certificate","operationId":"CreateCertificate","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafCreateCertificateResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafCreateCertificateRequest"}}},"required":true},"tags":["SSL"]}},"/waf/v1/stacks/{stack_id}/delivery/certificates/{certificate_id}":{"get":{"summary":"Get a certificate","operationId":"GetCertificate","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetCertificateResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"certificate_id","description":"A certificate ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["SSL"]},"delete":{"summary":"Delete a certificate","operationId":"DeleteCertificate","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"certificate_id","description":"A certificate ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["SSL"]},"put":{"summary":"Update a certificate","operationId":"UpdateCertificate","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafUpdateCertificateResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"certificate_id","description":"A certificate ID","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafUpdateCertificateRequest"}}},"required":true},"tags":["SSL"]}},"/waf/v1/stacks/{stack_id}/delivery/certificates/{certificate_id}/renew":{"post":{"summary":"Renew a certificate","description":"StackPath automatically renews certificates that are 30 days from expiration. Call this to retry a renewal that previously failed.","operationId":"RenewCertificate","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"certificate_id","description":"A certificate ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["SSL"]}},"/waf/v1/stacks/{stack_id}/delivery/certificates/{certificate_id}/verification_details":{"get":{"summary":"Get sites associated with a certificate","operationId":"GetCertificateVerificationDetails","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetCertificateVerificationDetailsResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"certificate_id","description":"A certificate ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["SSL"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/api_urls":{"put":{"summary":"Update API URLs","operationId":"UpdateSiteApiUrls","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafUpdateSiteApiUrlsResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafUpdateSiteApiUrlsRequest"}}},"required":true},"tags":["WAF Features"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/ddos":{"get":{"summary":"Get DDOS settings","operationId":"GetDdosSettings","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetDdosSettingsResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["WAF Features"]},"patch":{"summary":"Update DDOS settings","operationId":"UpdateDdosSettings","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafUpdateDdosSettingsResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafUpdateDdosSettingsRequest"}}},"required":true},"tags":["WAF Features"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/delivery/certificates":{"get":{"summary":"Get all site certificates","operationId":"GetSiteCertificates","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetSiteCertificatesResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"page_request.first","description":"The number of items desired.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.after","description":"The cursor value after which data will be returned.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.filter","description":"SQL-style constraint filters.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.sort_by","description":"Sort the response by the given field.","in":"query","required":false,"schema":{"type":"string"}}],"tags":["SSL"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/delivery/certificates/request":{"post":{"summary":"Request a free certificate","operationId":"RequestCertificate","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafRequestCertificateResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafRequestCertificateRequest"}}},"required":true},"tags":["SSL"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/delivery/certificates/{certificate_id}":{"put":{"summary":"Update SAN hosts","description":"Association is performed without validating if the site has a hostname covered by the certificate. This is useful for preparation work required for getting a site ready for traffic.\n\nIf a certificate is uploaded which contains hostnames for sites, it will automatically be connected to those sites. If a hostname is added to a site which is covered by an SSL certificate, it will automatically be connected to the certificate.","operationId":"ConnectSiteToCertificate","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafConnectSiteToCertificateResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"certificate_id","description":"A certificate ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["SSL"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/delivery/dns/targets":{"get":{"summary":"Get CNAME targets","description":"A site's hostname should point to these CNAME targets in order for traffic to be sent through StackPath's edge nodes.","operationId":"GetSiteDnsTargets","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetSiteDnsTargetsResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Configuration"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/monitoring":{"delete":{"summary":"Disable monitoring mode","description":"Restore the WAF feature's original enabled or disabled state.","operationId":"UnMonitorSite","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["WAF Features"]},"post":{"summary":"Enable monitoring mode","description":"Sites in monitoring mode accept incoming requests and log but take no action on policy and rule violations. A sitge's WAF feature must be enabled for monitoring mode to apply. Otherwise, monitoring mode will take effect the next time the WAF feature is enabled.","operationId":"MonitorSite","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["WAF Features"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/policy_groups":{"get":{"summary":"Get all policy groups","operationId":"GetPolicyGroups","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetPolicyGroupsResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Policies"]},"patch":{"summary":"Update policy groups","operationId":"UpdatePolicyGroups","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetPolicyGroupsResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafUpdatePolicyGroupsRequest"}}},"required":true},"tags":["Policies"],"description":"Provide the IDs and enabled states of the policies in their policy groups that should change"}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/policy_groups/{policy_group_id}":{"get":{"summary":"Get a policy group","operationId":"GetPolicyGroup","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetPolicyGroupResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"policy_group_id","description":"A WAF policy group ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Policies"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/policy_groups/{policy_group_id}/disable":{"post":{"summary":"Disable all policies in a group","operationId":"DisablePolicyGroup","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"policy_group_id","description":"A WAF policy group ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Policies"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/policy_groups/{policy_group_id}/enable":{"post":{"summary":"Enable all policies in a group","operationId":"EnablePolicyGroup","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"policy_group_id","description":"A WAF policy group ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Policies"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/policy_groups/{policy_group_id}/policies":{"get":{"summary":"Get all policies in a group","operationId":"GetPolicies","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetPoliciesResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"policy_group_id","description":"A WAF policy group ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Policies"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/policy_groups/{policy_group_id}/policies/{policy_id}":{"get":{"summary":"Get a policy","operationId":"GetPolicy","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetPolicyResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"policy_group_id","description":"A WAF policy group ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"policy_id","description":"A WAF policy ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Policies"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/policy_groups/{policy_group_id}/policies/{policy_id}/disable":{"post":{"summary":"Disable a policy","operationId":"DisablePolicy","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"policy_group_id","description":"A WAF policy group ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"policy_id","description":"A WAF policy ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Policies"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/policy_groups/{policy_group_id}/policies/{policy_id}/enable":{"post":{"summary":"Enable a policy","operationId":"EnablePolicy","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"policy_group_id","description":"A WAF policy group ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"policy_id","description":"A WAF policy ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Policies"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/request_stats":{"get":{"summary":"Get request statistics","description":"Request statistics collect the total number of and number of blocked requests for a site over a given time frame. Statistics are collected per country of origin, the rules that triggered the WAF, the requesting organization as determined by WHOIS lookup against the client IP address, and by actions taken by the WAF as a result of the request.","operationId":"GetRequestStatistics","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetRequestStatisticsResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"start_date","description":"A lower bound date to search requests for.","in":"query","required":false,"schema":{"type":"string","format":"date-time"}},{"name":"end_date","description":"An upper bound date to search requests for.","in":"query","required":false,"schema":{"type":"string","format":"date-time"}},{"name":"filter.action_value","in":"query","required":false,"schema":{"type":"string","enum":["ANY_ACTION","BLOCK_ACTION","ALLOW_ACTION","CAPTCHA_ACTION","HANDSHAKE_ACTION","MONITOR_ACTION"],"default":"ANY_ACTION"}},{"name":"filter.result_value","in":"query","required":false,"schema":{"type":"string","enum":["ANY_RESULT","BLOCKED_RESULT","ALLOWED_RESULT","MONITORED_RESULT"],"default":"ANY_RESULT"}},{"name":"filter.client_ip","description":"Filter requests by client IP address","in":"query","required":false,"schema":{"type":"string"}},{"name":"filter.reference_id","description":"Filter requests by reference ID. Reference IDs are displayed to the end user when the WAF blocks a request to a site. Please note that a request's ID and reference ID are different.","in":"query","required":false,"schema":{"type":"string"}}],"tags":["Requests"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/requests":{"get":{"summary":"Get all requests","operationId":"GetRequests","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetRequestsResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"page_request.first","description":"The number of items desired.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.after","description":"The cursor value after which data will be returned.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.filter","description":"SQL-style constraint filters.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.sort_by","description":"Sort the response by the given field.","in":"query","required":false,"schema":{"type":"string"}},{"name":"start_date","description":"A lower bound date to search requests for","in":"query","required":false,"schema":{"type":"string","format":"date-time"}},{"name":"end_date","description":"An upper bound date to search requests for","in":"query","required":false,"schema":{"type":"string","format":"date-time"}},{"name":"traffic_type","in":"query","required":false,"description":"The type of WAF traffic to search requests for\n - TRAFFIC_TYPE_UNSPECIFIED: Do not search for a traffic type\n - POLICY_BLOCKED: Search for traffic blocked by policies\n - CUSTOM_BLOCKED: Search for traffic blocked by rules\n - LEGIT: Search for traffic passed to the origin\n - CUSTOM_WHITELISTED: Search for traffic allowed by rules\n - POLICY_WHITELISTED: Search for traffic allowed by policies","schema":{"type":"string","enum":["TRAFFIC_TYPE_UNSPECIFIED","POLICY_BLOCKED","CUSTOM_BLOCKED","LEGIT","CUSTOM_WHITELISTED","POLICY_WHITELISTED"],"default":"TRAFFIC_TYPE_UNSPECIFIED"}}],"tags":["Requests"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/requests/{request_id}":{"get":{"summary":"Get a request","operationId":"GetRequest","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetRequestResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"request_id","description":"A WAF request ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Requests"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/requests/{request_id}/details":{"get":{"summary":"Get a request's details","operationId":"GetRequestDetails","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetRequestDetailsResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"request_id","description":"A WAF request ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Requests"],"description":"Retrieve more detailed information about a WAF request"}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/rules":{"get":{"summary":"Get all rules","operationId":"GetRules","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetRulesResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"page_request.first","description":"The number of items desired.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.after","description":"The cursor value after which data will be returned.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.filter","description":"SQL-style constraint filters.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.sort_by","description":"Sort the response by the given field.","in":"query","required":false,"schema":{"type":"string"}}],"tags":["Rules"]},"post":{"summary":"Create a rule","operationId":"CreateRule","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafCreateRuleResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafCreateRuleRequest"}}},"required":true},"tags":["Rules"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/rules/bulk_delete":{"post":{"summary":"Delete multiple rules","operationId":"BulkDeleteRules","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafBulkDeleteRulesRequest"}}},"required":true},"tags":["Rules"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/rules/{rule_id}":{"get":{"summary":"Get a rule","operationId":"GetRule","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetRuleResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"rule_id","description":"A WAF rule ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Rules"]},"delete":{"summary":"Delete a rule","operationId":"DeleteRule","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"rule_id","description":"A WAF rule ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Rules"]},"patch":{"summary":"Update a rule","description":"Only properties present in the request will be updated.","operationId":"UpdateRule","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafUpdateRuleResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"rule_id","description":"A WAF rule ID","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafUpdateRuleRequest"}}},"required":true},"tags":["Rules"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/rules/{rule_id}/disable":{"post":{"summary":"Disable a rule","operationId":"DisableRule","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"rule_id","description":"A WAF rule ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Rules"]}},"/waf/v1/stacks/{stack_id}/sites/{site_id}/rules/{rule_id}/enable":{"post":{"summary":"Enable a rule","operationId":"EnableRule","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"rule_id","description":"A WAF rule ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Rules"]}},"/waf/v1/tags":{"get":{"summary":"Get all tags","description":"Get tags available for use in WAF rule conditons. Tags describe aspects of an incoming web request and acn be used to create complex application-level custom rules.","operationId":"GetTags","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetTagsResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"page_request.first","description":"The number of items desired.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.after","description":"The cursor value after which data will be returned.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.filter","description":"SQL-style constraint filters.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.sort_by","description":"Sort the response by the given field.","in":"query","required":false,"schema":{"type":"string"}}],"tags":["WAF Features"]}},"/waf/v1alpha/stacks/{stack_id}/sites/{site_id}/advanced_rules":{"get":{"summary":"Get all advanced rules","operationId":"GetAdvancedRules","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetAdvancedRulesResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"page_request.first","description":"The number of items desired.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.after","description":"The cursor value after which data will be returned.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.filter","description":"SQL-style constraint filters.","in":"query","required":false,"schema":{"type":"string"}},{"name":"page_request.sort_by","description":"Sort the response by the given field.","in":"query","required":false,"schema":{"type":"string"}}],"tags":["Advanced Rules"],"description":"[block:callout]\n{\n  \"type\": \"danger\",\n  \"body\": \"This is an alpha API call and should be considered very unstable. Please do not execute this in a production environment. See our [versioning guidelines](doc:versioning) for more information.\"\n}\n[/block]"},"post":{"summary":"Create an advanced rule","operationId":"CreateAdvancedRule","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafCreateAdvancedRuleResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafCreateAdvancedRuleRequest"}}},"required":true},"tags":["Advanced Rules"],"description":"[block:callout]\n{\n  \"type\": \"danger\",\n  \"body\": \"This is an alpha API call and should be considered very unstable. Please do not execute this in a production environment. See our [versioning guidelines](doc:versioning) for more information.\"\n}\n[/block]"}},"/waf/v1alpha/stacks/{stack_id}/sites/{site_id}/advanced_rules/{rule_id}":{"get":{"summary":"Get an advanced rule","operationId":"GetAdvancedRule","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetAdvancedRuleResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"rule_id","description":"A WAF rule ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Advanced Rules"],"description":"[block:callout]\n{\n  \"type\": \"danger\",\n  \"body\": \"This is an alpha API call and should be considered very unstable. Please do not execute this in a production environment. See our [versioning guidelines](doc:versioning) for more information.\"\n}\n[/block]"},"delete":{"summary":"Delete an advanced rule","operationId":"DeleteAdvancedRule","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"rule_id","description":"A WAF rule ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Advanced Rules"],"description":"[block:callout]\n{\n  \"type\": \"danger\",\n  \"body\": \"This is an alpha API call and should be considered very unstable. Please do not execute this in a production environment. See our [versioning guidelines](doc:versioning) for more information.\"\n}\n[/block]"},"patch":{"summary":"Update an advanced rule","description":"[block:callout]\n{\n  \"type\": \"danger\",\n  \"body\": \"This is an alpha API call and should be considered very unstable. Please do not execute this in a production environment. See our [versioning guidelines](doc:versioning) for more information.\"\n}\n[/block]\n\nOnly properties present in the request will be updated.","operationId":"UpdateAdvancedRule","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafUpdateAdvancedRuleResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"rule_id","description":"A WAF rule ID","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafUpdateAdvancedRuleRequest"}}},"required":true},"tags":["Advanced Rules"]}},"/waf/v1alpha/stacks/{stack_id}/sites/{site_id}/advanced_rules/{rule_id}/disable":{"post":{"summary":"Disable an advanced rule","operationId":"DisableAdvancedRule","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"rule_id","description":"A WAF rule ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Advanced Rules"],"description":"[block:callout]\n{\n  \"type\": \"danger\",\n  \"body\": \"This is an alpha API call and should be considered very unstable. Please do not execute this in a production environment. See our [versioning guidelines](doc:versioning) for more information.\"\n}\n[/block]"}},"/waf/v1alpha/stacks/{stack_id}/sites/{site_id}/advanced_rules/{rule_id}/enable":{"post":{"summary":"Enable an advanced rule","operationId":"EnableAdvancedRule","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"rule_id","description":"A WAF rule ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Advanced Rules"],"description":"[block:callout]\n{\n  \"type\": \"danger\",\n  \"body\": \"This is an alpha API call and should be considered very unstable. Please do not execute this in a production environment. See our [versioning guidelines](doc:versioning) for more information.\"\n}\n[/block]"}},"/waf/v1alpha/stacks/{stack_id}/sites/{site_id}/raw_log_access":{"get":{"summary":"Get raw log access list","operationId":"GetRawLogAccessList","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetRawLogAccessListResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Raw Log Access"],"description":"[block:callout]\n{\n  \"type\": \"danger\",\n  \"body\": \"This is an alpha API call and should be considered very unstable. Please do not execute this in a production environment. See our [versioning guidelines](doc:versioning) for more information.\"\n}\n[/block]\n\nRetrieve a list of IPs or CIDRs with access to WAF raw logs"}},"/waf/v1alpha/stacks/{stack_id}/sites/{site_id}/raw_log_access/{ip}":{"delete":{"summary":"Revoke raw log access","operationId":"RevokeRawLogAccess","responses":{"204":{"description":"No content"},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"ip","description":"The IP or CIDR with mask /32 to revoke access to WAF raw logs","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Raw Log Access"],"description":"[block:callout]\n{\n  \"type\": \"danger\",\n  \"body\": \"This is an alpha API call and should be considered very unstable. Please do not execute this in a production environment. See our [versioning guidelines](doc:versioning) for more information.\"\n}\n[/block]"},"post":{"summary":"Grant raw log access","operationId":"GrantRawLogAccess","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGrantRawLogAccessResponse"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"path","required":true,"schema":{"type":"string"}},{"name":"ip","description":"The IP or CIDR with mask /32 to grant access to WAF raw logs","in":"path","required":true,"schema":{"type":"string"}}],"tags":["Raw Log Access"],"description":"[block:callout]\n{\n  \"type\": \"danger\",\n  \"body\": \"This is an alpha API call and should be considered very unstable. Please do not execute this in a production environment. See our [versioning guidelines](doc:versioning) for more information.\"\n}\n[/block]\n\nGrant raw log access to an IP or extend its expiration date if it is already granted"}},"/waf/v2/stacks/{stack_id}/traffic":{"get":{"summary":"Get traffic","operationId":"GetTrafficV2","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafGetTrafficV2Response"}}}},"401":{"description":"Returned when an unauthorized request is attempted.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"500":{"description":"Internal server error.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}},"default":{"description":"Default error structure.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/stackpathapiStatus"}}}}},"parameters":[{"name":"stack_id","description":"A stack ID or slug","in":"path","required":true,"schema":{"type":"string"}},{"name":"site_id","description":"A site ID","in":"query","required":false,"schema":{"type":"string"}},{"name":"start_date","description":"A lower bound date to search traffic for.","in":"query","required":false,"schema":{"type":"string","format":"date-time"}},{"name":"end_date","description":"An upper bound date to search traffic for.","in":"query","required":false,"schema":{"type":"string","format":"date-time"}},{"name":"resolution","in":"query","required":false,"description":" - DAILY: All data points represent one day of traffic\n - HOURLY: All data points represent one hour of traffic\n - MINUTELY: All data points represent one minute of traffic","schema":{"type":"string","enum":["DAILY","HOURLY","MINUTELY"],"default":"DAILY"}}],"tags":["Traffic"],"description":"Retreive a report of a stack or site's WAF traffic"}}},"security":[{"oauth2":[]}],"externalDocs":{"description":"The StackPath API Reference","url":"https://stackpath.dev/reference"},"x-explorer-enabled":true,"x-proxy-enabled":true,"x-samples-enabled":true,"x-samples-languages":["curl","node","ruby","javascript","python"],"servers":[{"url":"https://gateway.stackpath.com"}],"components":{"securitySchemes":{"oauth2":{"type":"oauth2","flows":{"clientCredentials":{"tokenUrl":"https://gateway.stackpath.com/identity/v1/oauth2/token","scopes":{}}}}},"schemas":{"AdvancedRuleExecutionPhase":{"type":"string","enum":["EXECUTION_PHASE_UNSPECIFIED","ACCESS","HEADER_FILTER","BODY_FILTER"],"default":"EXECUTION_PHASE_UNSPECIFIED","description":"The WAF request/response phase for applying the advanced rule\n\n- EXECUTION_PHASE_UNSPECIFIED: The phase to apply an advanced rule is unspecified\n - ACCESS: The advanced rule applies to request phase (request headers and body available)\n - HEADER_FILTER: The advanced rule applies to response headers phase\n - BODY_FILTER: The advanced rule applies to response body phase"},"ConditionContentTypeCondition":{"type":"object","properties":{"contentType":{"type":"string","description":"The Content-Type to match against\n\nThis must be groupings of `A-Z a-z 0-9 -` characters separated by a single slash"}},"description":"Match the requested Content-Type"},"ConditionCountryCondition":{"type":"object","properties":{"countryCode":{"type":"string","description":"An ISO 3166-1 alpha-2 formatted string"}},"description":"Match the country that the requested originated from"},"ConditionFileExtensionCondition":{"type":"object","properties":{"fileExtension":{"type":"string","description":"The file extension to match\n\nThis must be an optional period followed by a series of case-insensitive alphanumeric characters"}},"description":"Match the incoming file extension"},"ConditionHeaderCondition":{"type":"object","properties":{"header":{"type":"string","description":"The request header name"},"value":{"type":"string","description":"The request header value"},"exactMatch":{"type":"boolean","format":"boolean","description":"Whether or not to perform an exact match of the request header and value"}},"description":"Match an incoming request header"},"ConditionHeaderExistsCondition":{"type":"object","properties":{"header":{"type":"string","description":"The request header name"}},"description":"Match when an incoming request header is present"},"ConditionHttpMethodCondition":{"type":"object","properties":{"httpMethod":{"$ref":"#/components/schemas/wafHttpMethod"}},"description":"Match the incoming HTTP method"},"ConditionIpCondition":{"type":"object","properties":{"ipAddress":{"type":"string","description":"A single IPv4 address"}},"description":"Match the incoming request against a single IP address"},"ConditionIpRangeCondition":{"type":"object","properties":{"lowerBound":{"type":"string","description":"The lower bound IPv4 address to match against"},"upperBound":{"type":"string","description":"The upper bound IPv4 address to match against"}},"description":"Match the incoming request against a range of IPv4 addresses"},"ConditionOrganizationCondition":{"type":"object","properties":{"organization":{"type":"string","description":"The organization to match against"}},"description":"Match the organization the request originated from, as determined by a WHOIS lookup of the requesting IP"},"ConditionOwnerTypeCondition":{"type":"object","properties":{"ownerTypes":{"type":"array","items":{"$ref":"#/components/schemas/OwnerTypeConditionOwnerType"},"description":"The owner value to match against"}},"description":"Match the type of organization that owns the IP address making an incoming request"},"ConditionRequestRateCondition":{"type":"object","properties":{"ips":{"type":"array","items":{"type":"string"},"description":"A list of source IPs that can trigger a request rate condition"},"httpMethods":{"type":"array","items":{"$ref":"#/components/schemas/wafHttpMethod"},"description":"Possible HTTP request methods that can trigger a request rate condition"},"pathPattern":{"type":"string","description":"A regular expression matching the URL path of the incoming request"},"requests":{"type":"string","description":"The number of incoming requests over the given time that can trigger a request rate condition\n\nThis must be an integer greater than 20"},"time":{"type":"string","description":"The number of seconds that the WAF measures incoming requests over before triggering a request rate condition"}},"description":"Match the rate at which requests come in that match certain conditions"},"ConditionResponseHeaderCondition":{"type":"object","properties":{"header":{"type":"string","description":"The response header name"},"value":{"type":"string","description":"The response header value"},"exactMatch":{"type":"boolean","format":"boolean","description":"Whether to perform an exact match of the response header and value"}},"description":"Match a response header"},"ConditionResponseHeaderExistsCondition":{"type":"object","properties":{"header":{"type":"string","description":"The response header name"}},"description":"Match when a response header is present"},"ConditionSessionRequestCountCondition":{"type":"object","properties":{"requestCount":{"type":"string","description":"The number of dynamic requests in the session\n\nThis must be a value greater than zero"}},"description":"Match the number of dynamic page requests made in a WAF session\n\nThe WAF injects a session cookie into protected pages to track multi-request security issues. This condition matches against the number of dynamic page requests made during that session's lifetime."},"ConditionTagCondition":{"type":"object","properties":{"tags":{"type":"array","items":{"type":"string"},"description":"A facet of the incoming request to match against"}},"description":"Match aspects of an incoming request"},"ConditionUrlCondition":{"type":"object","properties":{"url":{"type":"string","description":"The URL path to match\n\nURL paths may only contain the characters `A-Z a-z 0-9 $ ~ : # [ ] @ ( ) * + , = / - _ . %`"},"exactMatch":{"type":"boolean","format":"boolean","description":"Whether to perform an exact match or a string contains match of the URL"}},"description":"Match the incoming request URL path"},"ConditionUserAgentCondition":{"type":"object","properties":{"userAgent":{"type":"string","description":"The user agent value to match"},"exactMatch":{"type":"boolean","format":"boolean","description":"Whether to perform an exact match or a string contains match of the user agent"}},"description":"Match the user agent making the request"},"MetricsActions":{"type":"object","properties":{"action":{"$ref":"#/components/schemas/wafRuleAction"},"count":{"type":"string","description":"The number of requests that resulted in that action"}},"description":"The number of requests per action taken by the WAF"},"MetricsCountries":{"type":"object","properties":{"country":{"type":"string","description":"A country's long name"},"countryCode":{"type":"string","description":"A country's ISO 3166-1 alpha-2 code"},"count":{"type":"string","description":"The number of requests from the country"}},"description":"The number of requests per country of origin"},"MetricsOrganizations":{"type":"object","properties":{"organization":{"type":"string","description":"An organization's name"},"count":{"type":"string","description":"The number of requests from the organization"}},"description":"The number of requests per requesting organization, as determined by WHOIS lookup on the requesting IP"},"MetricsRules":{"type":"object","properties":{"ruleName":{"type":"string","description":"The name of the rule"},"count":{"type":"string","description":"The number of requests the rule analyzed"}},"description":"The \"top threats\" metric, the number of requests encountered per rule"},"NetworkOrganization":{"type":"object","properties":{"name":{"type":"string","description":"The name of organization"},"subnet":{"type":"string","description":"The IP bock of the organization"}},"description":"The organization that owns the WAF request's originating IP address according to a WHOIS lookup"},"OwnerTypeConditionOwnerType":{"type":"string","enum":["COMMERCIAL","EDUCATIONAL","GOVERNMENT","HOSTING_SERVICES","ISP","MOBILE_NETWORK","NETWORK","RESERVED"],"default":"COMMERCIAL","description":"Potential source IP owner types to match against"},"RequestDetailsCommonTag":{"type":"object","properties":{"tag":{"type":"string","description":"The tag's name"},"displayName":{"type":"string","description":"The tag's human-readable name"},"description":{"type":"string","description":"The tag's description"}},"description":"General facets of a request captured by the WAF"},"RequestDetailsNetwork":{"type":"object","properties":{"clientIp":{"type":"string","description":"The originating IP address"},"country":{"type":"string","description":"The ISO 3166-1 alpha-2 code of the country where the request originated from"},"organization":{"$ref":"#/components/schemas/NetworkOrganization"}},"description":"A WAF request's network related aspects"},"RequestDetailsPatternMatchedTag":{"type":"object","properties":{"tag":{"type":"string","description":"The tag's name"},"displayName":{"type":"string","description":"The tag's human-readable name"},"description":{"type":"string","description":"The tag's description"},"field":{"type":"string","description":"The portion of the HTTP request where the matched pattern was found"},"fieldName":{"type":"string","description":"The name of the field that contains the matched pattern"},"patternName":{"type":"string","description":"The name of the pattern that triggered the tag"},"patternValue":{"type":"string","description":"The pattern found in the field that triggered the tag"},"executionPhase":{"type":"string","description":"The WAF request/response phase for applying the advanced rule"}},"description":"Specific facets of a WAF request that triggered an action"},"RequestDetailsRequestType":{"type":"string","enum":["API","AJAX","STATIC"],"default":"API","description":"The types of a WAF request\n\n- API: A WAF request to a URL designated by WAF as an API URL\n - AJAX: An AJAX WAF request\n - STATIC: A WAF request to a static resource"},"RequestDetailsUserAgent":{"type":"object","properties":{"fullString":{"type":"string","description":"The full user agent string for the WAF request"},"client":{"type":"string","description":"The name of the requesting client, typically the name of the requesting web browser"},"clientVersion":{"type":"string","description":"The version of the requesting user agent's client, typically also the version of the requesting web browser"},"baseBrowser":{"type":"string","description":"The name of the requesting user agent's browser"},"baseBrowserVersion":{"type":"string","description":"The version of the requesting user agent's browser"},"os":{"type":"string","description":"The name of the requesting user agent's operating system"},"device":{"type":"string","description":"The name of the requesting user agent's device"},"deviceType":{"type":"string","description":"The type of the requesting user agent's device"},"cpu":{"type":"string","description":"The name of the requesting user agent's CPU"},"renderingEngine":{"type":"string","description":"The name of the requesting user agent's engine"},"clientType":{"type":"string","description":"The type of the requesting user agent's client"}},"description":"A WAF request's user-agent related aspects"},"RequestStatisticsMetrics":{"type":"object","properties":{"rules":{"type":"array","items":{"$ref":"#/components/schemas/MetricsRules"},"description":"The \"top threats\" metric, the number of requests encountered per rule"},"countries":{"type":"array","items":{"$ref":"#/components/schemas/MetricsCountries"},"description":"The number of requests per country of origin"},"organizations":{"type":"array","items":{"$ref":"#/components/schemas/MetricsOrganizations"},"description":"The number of requests per requesting organization, as determined by WHOIS lookup on the requesting IP"},"actions":{"type":"array","items":{"$ref":"#/components/schemas/MetricsActions"},"description":"The number of requests per action taken by the WAF"}},"description":"A collection of common request metrics for a single WAF action"},"RuleCondition":{"type":"object","properties":{"ip":{"$ref":"#/components/schemas/ConditionIpCondition"},"ipRange":{"$ref":"#/components/schemas/ConditionIpRangeCondition"},"url":{"$ref":"#/components/schemas/ConditionUrlCondition"},"userAgent":{"$ref":"#/components/schemas/ConditionUserAgentCondition"},"header":{"$ref":"#/components/schemas/ConditionHeaderCondition"},"headerExists":{"$ref":"#/components/schemas/ConditionHeaderExistsCondition"},"responseHeader":{"$ref":"#/components/schemas/ConditionResponseHeaderCondition"},"responseHeaderExists":{"$ref":"#/components/schemas/ConditionResponseHeaderExistsCondition"},"httpMethod":{"$ref":"#/components/schemas/ConditionHttpMethodCondition"},"fileExtension":{"$ref":"#/components/schemas/ConditionFileExtensionCondition"},"contentType":{"$ref":"#/components/schemas/ConditionContentTypeCondition"},"country":{"$ref":"#/components/schemas/ConditionCountryCondition"},"organization":{"$ref":"#/components/schemas/ConditionOrganizationCondition"},"requestRate":{"$ref":"#/components/schemas/ConditionRequestRateCondition"},"ownerTypes":{"$ref":"#/components/schemas/ConditionOwnerTypeCondition"},"tags":{"$ref":"#/components/schemas/ConditionTagCondition"},"sessionRequestCount":{"$ref":"#/components/schemas/ConditionSessionRequestCountCondition"},"negation":{"type":"boolean","format":"boolean","description":"Whether or not to apply a boolean NOT operation to the rule's condition"}},"title":""},"SearchFilterActionFilter":{"type":"string","enum":["ANY_ACTION","BLOCK_ACTION","ALLOW_ACTION","CAPTCHA_ACTION","HANDSHAKE_ACTION","MONITOR_ACTION"],"default":"ANY_ACTION","description":"Potential actions the WAF took on a request"},"SearchFilterResultFilter":{"type":"string","enum":["ANY_RESULT","BLOCKED_RESULT","ALLOWED_RESULT","MONITORED_RESULT"],"default":"ANY_RESULT","description":"Potential final results the WAF took on the request\n\nA result reflects the end result of a request. For instance, if a user was first challenged with a captcha and then passed or failed the captcha."},"SiteAttachMode":{"type":"string","enum":["STANDALONE","ATTACHED"],"default":"STANDALONE","description":"How a WAF site relates to other StackPath site features\n\n- STANDALONE: This WAF site does not have a corresponding caching CDN site\n - ATTACHED: This WAF site represents the protection capabilities of a CDN site"},"apiStatusDetail":{"type":"object","properties":{"@type":{"type":"string"}},"required":["@type"],"discriminator":{"propertyName":"@type"}},"certificateCertificateStatusDetails":{"type":"object","properties":{"verificationFailures":{"type":"array","items":{"$ref":"#/components/schemas/certificateCertificateVerificationFailure"},"description":"Failures preventing the certificate from being issued"}},"description":"Detailed certificate status"},"certificateCertificateVerificationFailure":{"type":"object","properties":{"domain":{"type":"string","description":"The host the verification failed on"},"details":{"type":"string","description":"Detailed information about the failure"},"checkedAt":{"type":"string","format":"date-time","description":"The last time the failure was detected"}},"description":"A record that indicates why a domain is failing SSL validation"},"paginationPageInfo":{"type":"object","properties":{"totalCount":{"type":"string","description":"The total number of items in the dataset"},"hasPreviousPage":{"type":"boolean","format":"boolean","description":"Whether or not a previous page of data exists"},"hasNextPage":{"type":"boolean","format":"boolean","description":"Whether or not another page of data is available"},"startCursor":{"type":"string","description":"The cursor for the first item in the set of data returned"},"endCursor":{"type":"string","description":"The cursor for the last item in the set of data returned"}},"description":"Information about a paginated response\n\nThis is modeled after the GraphQL Relay spec to support both cursor based pagination and traditional offset based pagination."},"schemawafCertificate":{"type":"object","properties":{"id":{"type":"string","description":"A certificate's unique ID"},"fingerprint":{"type":"string","description":"A unique hash of a certificate's contents"},"commonName":{"type":"string","description":"A certificate's common name, or the primary domain name the certificate is used for"},"issuer":{"type":"string","description":"The name of the certificate's issuing certificate authority"},"caBundle":{"type":"string","description":"A PEM PKCS #7 formatted certificate authority bundle"},"trusted":{"type":"boolean","format":"boolean","description":"Whether or not the certificate's authority is trusted by a web browser"},"expirationDate":{"type":"string","format":"date-time","description":"The date an SSL certificate will expire"},"createDate":{"type":"string","format":"date-time","description":"The date an SSL certificate was created"},"updateDate":{"type":"string","format":"date-time","description":"The date an SSL certificate was last updated"},"subjectAlternativeNames":{"type":"array","items":{"type":"string"},"description":"A list of Subject Alternative Names in the certificate\n\nCertificates for multiple domains define their domains in certificate's SAN list."},"status":{"$ref":"#/components/schemas/schemawafCertificateStatus"},"providerManaged":{"type":"boolean","format":"boolean","description":"Whether a certificate is managed by StackPath or the end user"},"statusDetails":{"$ref":"#/components/schemas/certificateCertificateStatusDetails"}},"description":"An SSL certificate"},"schemawafCertificateStatus":{"type":"string","enum":["UNKNOWN","PENDING","EXPIRED","FAILED","PENDING_VERIFICATION","ACTIVE","INACTIVE"],"default":"UNKNOWN","description":"A StackPath-provided certificate's status\n\n- UNKNOWN: StackPath is unable to determine the certificate's status. This is the default status for end-user provided certificates.\n - PENDING: The certificate is provisioning\n - EXPIRED: The certificate has expired\n - FAILED: The certificate failed to provision\n - PENDING_VERIFICATION: The certificate is pending domain verification by the end user\n - ACTIVE: The certificate is valid and is in use by one or more hosts\n - INACTIVE: The certificate is valid but is not in use by any hosts"},"schemawafOrigin":{"type":"object","properties":{"path":{"type":"string","description":"An origin's path"},"hostname":{"type":"string","description":"An origin's fully-qualified domain name"},"port":{"type":"integer","format":"int32","description":"The http port to connect to the origin"},"securePort":{"type":"integer","format":"int32","description":"The https port to connect to the origin"}},"description":"A WAF site's origin"},"schemawafPolicy":{"type":"object","properties":{"id":{"type":"string","description":"A WAF policy's unique identifier"},"name":{"type":"string","readOnly":true,"description":"A WAF policy's name"},"description":{"type":"string","readOnly":true,"description":"A WAF policy's description"},"action":{"$ref":"#/components/schemas/wafPolicyAction"},"enabled":{"type":"boolean","format":"boolean","description":"Whether or not a WAF policy is enabled"}},"description":"An individually toggleable WAF policy\n\nPolicies are pre-defined WAF rules created by StackPath for common firewall functionality."},"stackpath.rpc.BadRequest":{"allOf":[{"$ref":"#/components/schemas/apiStatusDetail"},{"type":"object","properties":{"fieldViolations":{"type":"array","items":{"$ref":"#/components/schemas/stackpath.rpc.BadRequest.FieldViolation"}}}}]},"stackpath.rpc.BadRequest.FieldViolation":{"type":"object","properties":{"field":{"type":"string"},"description":{"type":"string"}}},"stackpath.rpc.Help":{"allOf":[{"$ref":"#/components/schemas/apiStatusDetail"},{"type":"object","properties":{"links":{"type":"array","items":{"$ref":"#/components/schemas/stackpath.rpc.Help.Link"}}}}]},"stackpath.rpc.Help.Link":{"type":"object","properties":{"description":{"type":"string"},"url":{"type":"string"}}},"stackpath.rpc.LocalizedMessage":{"allOf":[{"$ref":"#/components/schemas/apiStatusDetail"},{"type":"object","properties":{"locale":{"type":"string"},"message":{"type":"string"}}}]},"stackpath.rpc.PreconditionFailure":{"allOf":[{"$ref":"#/components/schemas/apiStatusDetail"},{"type":"object","properties":{"violations":{"type":"array","items":{"$ref":"#/components/schemas/stackpath.rpc.PreconditionFailure.Violation"}}}}]},"stackpath.rpc.PreconditionFailure.Violation":{"type":"object","properties":{"type":{"type":"string"},"subject":{"type":"string"},"description":{"type":"string"}}},"stackpath.rpc.QuotaFailure":{"allOf":[{"$ref":"#/components/schemas/apiStatusDetail"},{"type":"object","properties":{"violations":{"type":"array","items":{"$ref":"#/components/schemas/stackpath.rpc.QuotaFailure.Violation"}}}}]},"stackpath.rpc.QuotaFailure.Violation":{"type":"object","properties":{"subject":{"type":"string"},"description":{"type":"string"}}},"stackpath.rpc.RequestInfo":{"allOf":[{"$ref":"#/components/schemas/apiStatusDetail"},{"type":"object","properties":{"requestId":{"type":"string"},"servingData":{"type":"string"}}}]},"stackpath.rpc.ResourceInfo":{"allOf":[{"$ref":"#/components/schemas/apiStatusDetail"},{"type":"object","properties":{"resourceType":{"type":"string"},"resourceName":{"type":"string"},"owner":{"type":"string"},"description":{"type":"string"}}}]},"stackpath.rpc.RetryInfo":{"allOf":[{"$ref":"#/components/schemas/apiStatusDetail"},{"type":"object","properties":{"retryDelay":{"type":"string"}}}]},"stackpathapiStatus":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"details":{"type":"array","items":{"$ref":"#/components/schemas/apiStatusDetail"}}}},"wafAdvancedRule":{"type":"object","properties":{"id":{"type":"string","description":"An advanced rule's ID"},"name":{"type":"string","description":"An advanced rule's name"},"source":{"type":"string","description":"A CEL syntax expression that contains the advanced rule’s conditions."},"action":{"$ref":"#/components/schemas/wafAdvancedRuleAction"},"enabled":{"type":"boolean","format":"boolean","description":"Whether or not an advanced WAF rule is enabled"},"statusCode":{"$ref":"#/components/schemas/wafAdvancedRuleStatusCode"},"actionDuration":{"type":"string","description":"How long a rule's block action will apply to subsequent requests\n\nDurations only apply to rules with block actions."},"description":{"type":"string","description":"A rule's description"},"phase":{"$ref":"#/components/schemas/AdvancedRuleExecutionPhase"}},"description":"An advanced WAF rule applied to a site\n\nUnlike pre-defined policies, advanced rules are provided by the user for flexible WAF functionality."},"wafAdvancedRuleAction":{"type":"string","enum":["ACTION_UNSPECIFIED","BLOCK","ALLOW","CAPTCHA","HANDSHAKE","MONITOR"],"default":"ACTION_UNSPECIFIED","description":"The actions that the WAF takes when an advanced rule is triggered\n\n- ACTION_UNSPECIFIED: The action is undetermined\n - BLOCK: The WAF blocked the request\n - ALLOW: The WAF allowed the request\n - CAPTCHA: The WAF presented the user with a captcha\n - HANDSHAKE: The WAF performed automatic browser validation\n - MONITOR: The WAF monitored the request but took no action"},"wafAdvancedRuleStatusCode":{"type":"string","enum":["STATUS_CODE_UNSPECIFIED","NONE","FORBIDDEN_403","TOO_MANY_REQUESTS_429","METHOD_NOT_ALLOWED_405","I_AM_TEAPOT_418"],"default":"STATUS_CODE_UNSPECIFIED","description":"A custom HTTP status code that the WAF returns if a rule blocks a request"},"wafBulkDeleteRulesRequest":{"type":"object","properties":{"ruleIds":{"type":"array","items":{"type":"string"},"description":"The IDs of the rules to delete"}},"title":""},"wafCertificateVerificationMethod":{"type":"string","enum":["DNS","HTTP"],"default":"DNS","description":"The Certificate Verification Method\n\nVerification method used to validate a requested certificate on a site\n\n - DNS: Verify a certificate using DNS records\n - HTTP: Verify a certificate by using HTTP validation. This will require that all hosts on the certificate point to the site hash or IP"},"wafConnectSiteToCertificateResponse":{"type":"object","properties":{"siteCertificate":{"$ref":"#/components/schemas/wafSiteCertificate"}},"description":"A response to a request to associate an SSL certificate with a WAF site"},"wafCreateAdvancedRuleRequest":{"type":"object","properties":{"name":{"type":"string","description":"An advanced rule's name"},"source":{"type":"string","description":"A [CEL syntax](https://opensource.google/projects/cel) expression that contains the advanced rule’s conditions"},"action":{"$ref":"#/components/schemas/wafAdvancedRuleAction"},"enabled":{"type":"boolean","format":"boolean","description":"Whether or not an advanced WAF rule is enabled"},"statusCode":{"$ref":"#/components/schemas/wafAdvancedRuleStatusCode"},"actionDuration":{"type":"string","description":"How long a rule's block action will apply to subsequent requests\n\nDurations only apply to rules with block actions."},"description":{"type":"string","description":"A rule's description"},"phase":{"$ref":"#/components/schemas/AdvancedRuleExecutionPhase"}},"title":""},"wafCreateAdvancedRuleResponse":{"type":"object","properties":{"rule":{"$ref":"#/components/schemas/wafAdvancedRule"}},"description":"The results from a request to create an advanced WAF rule"},"wafCreateCertificateRequest":{"type":"object","properties":{"certificate":{"type":"string","description":"A PEM PKCS #7 formatted SSL certificate"},"key":{"type":"string","description":"A PEM PKCS #7 formatted private key\n\nPrivate keys are sent directly to the edge nodes and are not stored elsewhere on StackPath's systems."},"caBundle":{"type":"string","description":"A PEM PKCS #7 formatted certificate authority bundle"}},"title":""},"wafCreateCertificateResponse":{"type":"object","properties":{"certificate":{"$ref":"#/components/schemas/schemawafCertificate"}},"description":"A response from a request to add an SSL certificate to a stack"},"wafCreateRuleRequest":{"type":"object","properties":{"name":{"type":"string","description":"The WAF rule's name"},"description":{"type":"string","description":"A rule's description"},"conditions":{"type":"array","items":{"$ref":"#/components/schemas/RuleCondition"},"description":"The conditions required for a WAF rule to trigger"},"action":{"$ref":"#/components/schemas/wafRuleAction"},"enabled":{"type":"boolean","format":"boolean","description":"Whether or not the rule should be enabled on creation"},"statusCode":{"$ref":"#/components/schemas/wafRuleStatusCode"},"actionDuration":{"type":"string","description":"How long a rule's block action will apply to subsequent requests\n\nDurations only apply to rules with block actions."}},"title":""},"wafCreateRuleResponse":{"type":"object","properties":{"rule":{"$ref":"#/components/schemas/wafRule"}},"description":"The results from a request to create a WAF rule"},"wafCreateSiteRequestOrigin":{"type":"object","properties":{"path":{"type":"string","description":"The path the WAF should request from the origin"},"hostname":{"type":"string","description":"The origin's fully-qualified domain name"},"port":{"type":"integer","format":"int32","description":"The TCP port the WAF should connect to for http requests"},"securePort":{"type":"integer","format":"int32","description":"The TCP port the WAF should connect to for https requests"},"hostHeader":{"type":"string","description":"The value of the Host header that the WAF should set when requesting from the origin. This field is deprecated and should not be used."}},"description":"A WAF site's origin"},"wafCreateSiteRequestType":{"type":"string","enum":["WAF","API"],"default":"WAF","description":"A WAF site's type\n\nA site's type determines how StackPath delivers content to incoming HTTP requests.\n\n - WAF: The site is either a standalone WAF site or a WAF site with attached CDN service\n - API: The site is an API delivery site. API delivery sites are powered by both the WAF and CDN and have custom rulesets for each."},"wafDdosSettings":{"type":"object","properties":{"globalThreshold":{"type":"string","description":"The number of overall requests per ten seconds that can trigger DDOS protection"},"burstThreshold":{"type":"string","description":"The number of requests per two seconds that can trigger DDOS protection"},"subSecondBurstThreshold":{"type":"string","description":"The number of requests per 0.1 seconds that can trigger DDOS protection"}},"description":"A WAF site's DDOS protection settings\n\nDDOS protection is activated if at least one of these conditions is met."},"wafDnsRecord":{"type":"object","properties":{"name":{"type":"string","description":"The name of the network node to which a zone resource record pertains\n\nUse the value \"@\" to denote current root domain name."},"type":{"type":"string","description":"A zone record's type\n\nZone record types describe the zone record's behavior. For instance, a zone record's type can say that the record is a name to IP address value, a name alias, or which mail exchanger is responsible for the domain. See https://support.stackpath.com/hc/en-us/articles/360001085563-What-DNS-record-types-does-StackPath-support for more information."},"class":{"type":"string","description":"A zone record's class code\n\nThis is typically \"IN\" for Internet related resource records."},"ttl":{"type":"integer","format":"int32","description":"A zone record's time to live\n\nA record's TTL is the number of seconds that the record should be cached by DNS resolvers. Use lower TTL values if you expect zone records to change often. Use higher TTL values for records that won't change to prevent extra DNS lookups by clients."},"data":{"type":"string","description":"A zone record's value\n\nExpected data formats can vary depending on the zone record's type."}},"description":"A DNS record\n\nA dns record describes an individual piece of DNS functionality in a DNS zone."},"wafDnsVerificationDetails":{"type":"object","properties":{"dnsRecords":{"type":"array","items":{"type":"string"},"description":"A list of DNS records that will validate domain ownership"},"records":{"type":"array","items":{"$ref":"#/components/schemas/wafDnsRecord"},"description":"A list of parsed dns records required for SSL verification"}},"description":"DNS-based domain ownership verification details"},"wafGetAdvancedRuleResponse":{"type":"object","properties":{"rule":{"$ref":"#/components/schemas/wafAdvancedRule"}},"description":"The results from a request to retrieve an advanced WAF rule"},"wafGetAdvancedRulesResponse":{"type":"object","properties":{"pageInfo":{"$ref":"#/components/schemas/paginationPageInfo"},"rules":{"type":"array","items":{"$ref":"#/components/schemas/wafAdvancedRule"},"description":"The requested WAF advanced rules"}},"description":"The results from a request to retrieve a site's WAF advanced rules"},"wafGetCertificateResponse":{"type":"object","properties":{"certificate":{"$ref":"#/components/schemas/schemawafCertificate"}},"description":"A response from a request to retrieve an individual SSL certificate on a stack"},"wafGetCertificateVerificationDetailsResponse":{"type":"object","properties":{"manualVerificationRequired":{"type":"boolean","format":"boolean","description":"Whether or not the end user must provide their own certificate verification"},"verificationRequirements":{"type":"array","items":{"$ref":"#/components/schemas/wafVerificationRequirements"},"description":"An SSL certificate's verification requirements"},"statusDetails":{"$ref":"#/components/schemas/certificateCertificateStatusDetails"}},"description":"A response from a request to retrieve an SSL certificate's manual verification details"},"wafGetCertificatesResponse":{"type":"object","properties":{"pageInfo":{"$ref":"#/components/schemas/paginationPageInfo"},"results":{"type":"array","items":{"$ref":"#/components/schemas/schemawafCertificate"},"description":"The requested SSL certificates"}},"description":"A response from a request to retrieve a stack's SSL certificates"},"wafGetDdosSettingsResponse":{"type":"object","properties":{"ddosSettings":{"$ref":"#/components/schemas/wafDdosSettings"}},"description":"A response from a request to retrieve a WAF site's DDOS protection settings"},"wafGetPoliciesResponse":{"type":"object","properties":{"policies":{"type":"array","items":{"$ref":"#/components/schemas/schemawafPolicy"},"description":"The requested WAF policies"}},"description":"A response from a request to retrieve a WAF policy group"},"wafGetPolicyGroupResponse":{"type":"object","properties":{"policyGroup":{"$ref":"#/components/schemas/wafPolicyGroup"}},"description":"A response from a request to retrieve a WAF policy group"},"wafGetPolicyGroupsResponse":{"type":"object","properties":{"policyGroups":{"type":"array","items":{"$ref":"#/components/schemas/wafPolicyGroup"},"description":"The requested WAF policy groups"}},"description":"A response from a request to retrieve a WAF site's policy groups"},"wafGetPolicyResponse":{"type":"object","properties":{"policy":{"$ref":"#/components/schemas/schemawafPolicy"}},"description":"A response from a request to retrieve an individual WAF policy"},"wafGetRawLogAccessListResponse":{"type":"object","properties":{"results":{"type":"array","items":{"$ref":"#/components/schemas/wafRawLogAccessIP"},"description":"The requested information about IPs or CIDRs that have access to WAF site raw logs"}},"description":"A response from a request to retrieve a list of IPs or CIDRs with access to WAF raw logs"},"wafGetRequestDetailsResponse":{"type":"object","properties":{"requestDetails":{"$ref":"#/components/schemas/wafRequestDetails"}},"description":"A response from a request to retrieve all available information about a request to a WAF site"},"wafGetRequestResponse":{"type":"object","properties":{"request":{"$ref":"#/components/schemas/wafRequest"}},"description":"A response from a request to retrieve information about a request to a WAF site"},"wafGetRequestStatisticsResponse":{"type":"object","properties":{"statistics":{"$ref":"#/components/schemas/wafRequestStatistics"}},"description":"A response from a request to retrieve a WAF site's request statistics"},"wafGetRequestsResponse":{"type":"object","properties":{"pageInfo":{"$ref":"#/components/schemas/paginationPageInfo"},"results":{"type":"array","items":{"$ref":"#/components/schemas/wafRequest"},"description":"The requested information about a WAF site's requests"}},"description":"The requested WAF requests"},"wafGetRuleResponse":{"type":"object","properties":{"rule":{"$ref":"#/components/schemas/wafRule"}},"description":"The results from a request to retrieve a WAF rule"},"wafGetRulesResponse":{"type":"object","properties":{"pageInfo":{"$ref":"#/components/schemas/paginationPageInfo"},"rules":{"type":"array","items":{"$ref":"#/components/schemas/wafRule"},"description":"The requested WAF rules"}},"description":"The results from a request to retrieve a site's WAF rules"},"wafGetSiteCertificatesResponse":{"type":"object","properties":{"pageInfo":{"$ref":"#/components/schemas/paginationPageInfo"},"results":{"type":"array","items":{"$ref":"#/components/schemas/wafSiteCertificate"},"description":"The requested SSL certificates"}},"description":"A response from a request to retrieve a WAF site's SSL certificates"},"wafGetSiteDnsTargetsResponse":{"type":"object","properties":{"addresses":{"type":"array","items":{"type":"string"},"description":"A list of DNS CNAME targets"}},"description":"A response from a request to retrieve a WAF site's DNS CNAME targets"},"wafGetTagsResponse":{"type":"object","properties":{"results":{"type":"array","items":{"$ref":"#/components/schemas/wafTag"},"description":"The requested WAF tags"},"pageInfo":{"$ref":"#/components/schemas/paginationPageInfo"}},"description":"A response from a request to retrieve WAF tags"},"wafGetTrafficV2Response":{"type":"object","properties":{"traffic":{"type":"array","items":{"$ref":"#/components/schemas/wafTrafficV2"},"description":"The requested WAF traffic"}},"description":"A response from a request to retrieve a stack's WAF traffic"},"wafGetWAFOrganizationsResponse":{"type":"object","properties":{"pageInfo":{"$ref":"#/components/schemas/paginationPageInfo"},"results":{"type":"array","items":{"$ref":"#/components/schemas/wafWAFOrganization"},"description":"The requested WHOIS organizations"}},"description":"A response for a request to get a WHOIS organization"},"wafGrantRawLogAccessResponse":{"type":"object","properties":{"rawLogAccessIp":{"$ref":"#/components/schemas/wafRawLogAccessIP"}},"description":"A response from a request to grant raw log access"},"wafHttpMethod":{"type":"string","enum":["METHOD_UNSPECIFIED","GET","POST","PUT","DELETE","HEAD","PATCH","OPTIONS","CONNECT","TRACE"],"default":"METHOD_UNSPECIFIED","description":"HTTP methods of a request\n\n- METHOD_UNSPECIFIED: Unspecified HTTP method\n - GET: HTTP GET method\n - POST: HTTP POST method\n - PUT: HTTP PUT method\n - DELETE: HTTP DELETE method\n - HEAD: HTTP HEAD method\n - PATCH: HTTP PATCH method\n - OPTIONS: HTTP OPTIONS method\n - CONNECT: HTTP CONNECT method\n - TRACE: HTTP TRACE method"},"wafHttpVerificationDetails":{"type":"object","properties":{"path":{"type":"string","description":"Path to the verification file"},"contentType":{"type":"string","description":"Response content type"},"body":{"type":"string","description":"Body content of response"}},"description":"HTTP-based domain ownership verification details"},"wafPolicyAction":{"type":"string","enum":["BLOCK","ALLOW","CAPTCHA","HANDSHAKE","MONITOR"],"default":"BLOCK","readOnly":true,"description":"The potential actions that the WAF will take when a policy is triggered"},"wafPolicyGroup":{"type":"object","properties":{"id":{"type":"string","description":"A policy group's ID"},"name":{"type":"string","readOnly":true,"description":"A policy group's name"},"policies":{"type":"array","items":{"$ref":"#/components/schemas/schemawafPolicy"},"description":"A list of the policies in a policy group"}},"description":"A group of WAF policies with similar effect"},"wafRawLogAccessIP":{"type":"object","properties":{"ip":{"type":"string","description":"The IP or CIDR with access to WAF raw logs"},"expiryAt":{"type":"string","format":"date-time","description":"The date an access to WAF raw logs will expire"}},"description":"Information about IP or CIDR with access to WAF raw logs"},"wafRequest":{"type":"object","properties":{"id":{"type":"string","description":"The WAF request's unique identifier"},"path":{"type":"string","description":"The path of the requested URL"},"clientIp":{"type":"string","description":"The originating IP address"},"method":{"$ref":"#/components/schemas/wafHttpMethod"},"ruleName":{"type":"string","description":"The name of the WAF rule triggered by the request"},"country":{"type":"string","description":"The ISO 3166-1 alpha-2 code of the country where the request originated from"},"action":{"$ref":"#/components/schemas/wafRequestAction"},"ruleId":{"type":"string","description":"The unique ID of the WAF rule that triggered the action against the request"},"userAgent":{"type":"string","description":"The full user agent string for the request"},"userAgentClient":{"type":"string","description":"The name of the requesting client, typically the name of the requesting web browser"},"organization":{"type":"string","description":"The organization that owns the request's originating IP address according to a WHOIS lookup"},"requestTime":{"type":"string","format":"date-time","description":"When the WAF request occurred"},"referenceId":{"type":"string","description":"The request's user-facing identifier\n\nReference IDs are displayed to the end user when the WAF blocks a request to a site. Please note that a request's ID and reference ID are different."},"statusCode":{"type":"string","description":"The HTTP status code of the request"},"result":{"$ref":"#/components/schemas/wafRequestResult"},"trafficTypes":{"type":"array","items":{"type":"string"},"description":"The kinds of traffic in the request flagged by the WAF"}},"description":"A request that was inspected by the WAF"},"wafRequestAction":{"type":"string","enum":["ACTION_UNSPECIFIED","BLOCK","ALLOW","CAPTCHA","HANDSHAKE","MONITOR","INSPECT"],"default":"ACTION_UNSPECIFIED","description":"The actions that the WAF takes when a request triggers a WAF rule\n\n- ACTION_UNSPECIFIED: The WAF performed an unspecified action with the request\n - BLOCK: The WAF blocked the request\n - ALLOW: The WAF allowed the request\n - CAPTCHA: The WAF presented the user with a captcha\n - HANDSHAKE: The WAF performed automatic browser validation\n - MONITOR: The WAF monitored the request but took no action"},"wafRequestCertificateRequest":{"type":"object","properties":{"hosts":{"type":"array","items":{"type":"string"},"description":"An optional list of delivery domains that will be included as subject alternative names on the certificate\n\nIf no hosts are provided, all delivery domains on the site will be included with the first one in the list being used as the common name.  If hosts are provided the first entry will be used as the common name.\nIf the first host in the list is over 63 characters the shortest host provided will be used as the common name.\n\nAll entries in the list are validated against the existing delivery domains for the provided site."},"verificationMethod":{"$ref":"#/components/schemas/wafCertificateVerificationMethod"}},"title":""},"wafRequestCertificateResponse":{"type":"object","properties":{"certificate":{"$ref":"#/components/schemas/schemawafCertificate"},"verificationRequirements":{"type":"array","items":{"$ref":"#/components/schemas/wafVerificationRequirements"},"description":"The certificate's verification requirements"}},"description":"A response from a request to provision an SSL certificate for a WAF site"},"wafRequestDetails":{"type":"object","properties":{"id":{"type":"string","description":"The WAF request's unique identifier"},"path":{"type":"string","description":"The path of the requested URL"},"method":{"$ref":"#/components/schemas/wafHttpMethod"},"action":{"$ref":"#/components/schemas/wafRequestAction"},"ruleId":{"type":"string","description":"The unique ID of the WAF rule that triggered the action against the WAF request"},"ruleName":{"type":"string","description":"The name of the WAF rule triggered by the request"},"userAgent":{"$ref":"#/components/schemas/RequestDetailsUserAgent"},"network":{"$ref":"#/components/schemas/RequestDetailsNetwork"},"requestTime":{"type":"string","format":"date-time","description":"When the WAF request occurred"},"referenceId":{"type":"string","description":"The WAF request's user-facing identifier\n\nReference IDs are displayed to the end user when the WAF blocks a request to a site. Please note that a request's ID and reference ID are different."},"contentType":{"type":"string","description":"The content type of the WAF request"},"scheme":{"type":"string","description":"The HTTP scheme of the WAF request"},"httpStatusCode":{"type":"string","description":"The HTTP status code of the WAF request"},"httpVersion":{"type":"string","description":"The HTTP version of the WAF request"},"responseTime":{"type":"string","description":"The time it took the WAF to process the WAF request"},"requestHeaders":{"type":"object","additionalProperties":{"type":"string"},"description":"The HTTP request headers of the WAF request"},"incidentId":{"type":"string","description":"The ID of the of challenge that was generated for the WAF request"},"requestType":{"$ref":"#/components/schemas/RequestDetailsRequestType"},"sessionRequestCount":{"type":"string","description":"The number of WAF requests in the session"},"domain":{"type":"string","description":"The internal delivery domain used by the CDN and WAF to deliver content"},"requestedDomain":{"type":"string","description":"The domain requested in the original HTTP request from the end user"},"queryString":{"type":"string","description":"The query string of the request"},"result":{"$ref":"#/components/schemas/wafRequestResult"},"trafficTypes":{"type":"array","items":{"type":"string"},"description":"The kinds of traffic in the request flagged by the WAF"},"patternMatchedTags":{"type":"array","items":{"$ref":"#/components/schemas/RequestDetailsPatternMatchedTag"},"description":"Specific facets of a WAF request that triggered an action"},"commonTags":{"type":"array","items":{"$ref":"#/components/schemas/RequestDetailsCommonTag"},"description":"General facets of a request captured by the WAF"}},"description":"A request that was inspected by the WAF"},"wafRequestResult":{"type":"string","enum":["CHALLENGE_REQUEST_RESULT_UNSPECIFIED","PASSED","BLOCKED"],"default":"CHALLENGE_REQUEST_RESULT_UNSPECIFIED","description":"The request's end result\n\n- CHALLENGE_REQUEST_RESULT_UNSPECIFIED: The result is undetermined\n - PASSED: The request is passed to origin\n - BLOCKED: The request is blocked by WAF"},"wafRequestStatistics":{"type":"object","properties":{"count":{"$ref":"#/components/schemas/RequestStatisticsMetrics"},"blocked":{"$ref":"#/components/schemas/RequestStatisticsMetrics"}},"description":"A collection of common request metrics"},"wafRule":{"type":"object","properties":{"id":{"type":"string","description":"A rule's ID"},"name":{"type":"string","description":"A rule's name"},"description":{"type":"string","description":"A rule's description"},"conditions":{"type":"array","items":{"$ref":"#/components/schemas/RuleCondition"},"description":"The conditions required for the WAF engine to trigger the rule\n\nRules may have between 1 and 5 conditions. All conditions must pass for the rule to trigger."},"action":{"$ref":"#/components/schemas/wafRuleAction"},"enabled":{"type":"boolean","format":"boolean","description":"Whether or not a WAF rule is enabled"},"actionDuration":{"type":"string","description":"How long a rule's block action will apply to subsequent requests\n\nDurations only apply to rules with block actions."},"statusCode":{"$ref":"#/components/schemas/wafRuleStatusCode"}},"description":"A custom WAF rule applied to a site\n\nUnlike pre-defined policies, rules are provided by the user for custom WAF functionality."},"wafRuleAction":{"type":"string","enum":["BLOCK","ALLOW","CAPTCHA","HANDSHAKE","MONITOR","GATEWAY"],"default":"BLOCK","description":"The actions that the WAF takes when a rule is triggered\n\n- BLOCK: The WAF blocked the request\n - ALLOW: The WAF allowed the request\n - CAPTCHA: The WAF presented the user with a captcha\n - HANDSHAKE: The WAF performed automatic browser validation\n - MONITOR: The WAF monitored the request but took no action\n - GATEWAY: The WAF performed extended automatic browser validation"},"wafRuleStatusCode":{"type":"string","enum":["FORBIDDEN_403","TOO_MANY_REQUESTS_429"],"default":"FORBIDDEN_403","description":"A custom HTTP status code that the WAF returns if a rule blocks a request"},"wafSite":{"type":"object","properties":{"id":{"type":"string","description":"A WAF site's unique identifier"},"name":{"type":"string","description":"The WAF site's name, used on stand-alone WAF sites"},"enabled":{"type":"boolean","format":"boolean","description":"Whether or not a site's WAF service is enabled"},"apiUrls":{"type":"array","items":{"type":"string"},"description":"A list of API URLs which receive different processing through the WAF than website requests"},"createdAt":{"type":"string","format":"date-time","description":"The date a WAF site was created"},"updatedAt":{"type":"string","format":"date-time","description":"The date a WAF site was last updated"},"status":{"$ref":"#/components/schemas/wafSiteStatus"},"mode":{"$ref":"#/components/schemas/SiteAttachMode"},"deliveryId":{"type":"string","description":"For an ATTACHED site, the CDN site ID where caching can be enabled"},"type":{"$ref":"#/components/schemas/wafSiteType"},"monitoring":{"type":"boolean","format":"boolean","description":"Whether or not a site's WAF service is in a monitor state\n\nWAF sites in monitoring mode accept incoming requests and log but take no action on policy and rule violations."}},"description":"A site's WAF service's general settings"},"wafSiteCertificate":{"type":"object","properties":{"valid":{"type":"boolean","format":"boolean","description":"Whether or not a site's SSL certificate is valid\n\nAn SSL certificate is valid when a hostname associated with the site is covered by the certificate."},"certificate":{"$ref":"#/components/schemas/schemawafCertificate"}},"description":"An SSL certificate and its relationship with its associated site"},"wafSiteStatus":{"type":"string","enum":["ACTIVE","INACTIVE","SUSPENDED","BILLING_SUSPENDED","PROVISIONING"],"default":"ACTIVE","description":"A WAF site's available statuses\n\n- ACTIVE: A WAF site is in active service\n - INACTIVE: A WAF site has been disabled by the user\n - SUSPENDED:  A WAF site has been disabled by StackPath for non-billing reasons (DMCA, abuse, etc)\n - BILLING_SUSPENDED: A WAF site has been disabled by StackPath for billing reasons\n - PROVISIONING: A WAF site is provisioning"},"wafSiteType":{"type":"string","enum":["UNKNOWN_TYPE","WAF","API"],"default":"UNKNOWN_TYPE","description":"A WAF site's type\n\nA site's type determines how StackPath delivers content to incoming HTTP(S) requests.\n\n - UNKNOWN_TYPE: StackPath is unable to determine a site's type\n - WAF: A site is either a standalone WAF site or a WAF site with attached CDN service\n - API: A site is an API delivery site. API delivery sites are powered by both the WAF and CDN and have custom rulesets for each."},"wafTag":{"type":"object","properties":{"name":{"type":"string","description":"A tag's name"},"description":{"type":"string","description":"A tag's human readable description"}},"description":"Aspects of an incoming HTTP request\n\nStackPath provides shortcuts for the rules used in WAF policies for the creation of more complex WAF rules."},"wafTrafficV2":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time","description":"The date and time traffic metrics were recorded for"},"api":{"type":"string","description":"The number of requests to URLs designated as API URLs"},"ajax":{"type":"string","description":"The number of Ajax requests"},"static":{"type":"string","description":"The number of requests to static assets"},"customBlocked":{"type":"string","description":"The number of requests blocked by custom rules"},"policyBlocked":{"type":"string","description":"The number of requests blocked by policies"},"ddosBlocked":{"type":"string","description":"The number of requests blocked by layer 7 DDOS protection"},"monitored":{"type":"string","description":"The number of monitored requests"},"customWhitelisted":{"type":"string","description":"The number of requests allowed by custom rules"},"policyWhitelisted":{"type":"string","description":"The number of requests from allowed search engines and other allowed bots"},"originError4xx":{"type":"string","description":"The number of HTTP 4xx errors received from the origin"},"originError5xx":{"type":"string","description":"The number of HTTP 5xx errors received from the origin"},"originTimeout":{"type":"string","description":"The number of request timeouts from the WAF to the origin"},"uncategorized":{"type":"string","description":"The number of uncategorized requests"},"passedToOrigin":{"type":"string","description":"The number of requests that were passed to the origin"},"responseTime":{"type":"string","description":"The average response time to the origin in milliseconds"},"total":{"type":"string","description":"The total number of requests for the given time period"}},"description":"A set of individual time-series WAF traffic metrics"},"wafUpdateAdvancedRuleRequest":{"type":"object","properties":{"name":{"type":"string","description":"An advanced rule's name"},"source":{"type":"string","description":"A [CEL syntax](https://opensource.google/projects/cel) expression that contains the advanced rule’s conditions"},"actionValue":{"$ref":"#/components/schemas/wafAdvancedRuleAction"},"enabled":{"type":"boolean","format":"boolean","description":"Whether or not an advanced WAF rule is enabled"},"statusCode":{"$ref":"#/components/schemas/wafAdvancedRuleStatusCode"},"actionDuration":{"type":"string","description":"How long a rule's block action will apply to subsequent requests\n\nDurations only apply to rules with block actions."},"description":{"type":"string","description":"A rule's description"},"executionPhase":{"$ref":"#/components/schemas/AdvancedRuleExecutionPhase"}},"title":""},"wafUpdateAdvancedRuleResponse":{"type":"object","properties":{"rule":{"$ref":"#/components/schemas/wafAdvancedRule"}},"description":"The results from a request to update an advanced WAF rule"},"wafUpdateCertificateRequest":{"type":"object","properties":{"certificate":{"type":"string","description":"A PEM PKCS #7 formatted SSL certificate"},"key":{"type":"string","description":"A PEM PKCS #7 formatted private key\n\nPrivate keys are sent directly to the edge nodes and are not stored elsewhere on StackPath's systems."},"caBundle":{"type":"string","description":"A PEM PKCS #7 formatted certificate authority bundle"}},"title":""},"wafUpdateCertificateResponse":{"type":"object","properties":{"certificate":{"$ref":"#/components/schemas/schemawafCertificate"}},"description":"A response from a request to update an SSL certificate"},"wafUpdateDdosSettingsRequest":{"type":"object","properties":{"globalThreshold":{"type":"string","description":"The number of requests per ten seconds that can trigger DDOS protection"},"burstThreshold":{"type":"string","description":"The number of requests per two seconds that can trigger DDOS protection"},"subSecondBurstThreshold":{"type":"string","description":"The number of requests per 0.1 seconds that can trigger DDOS protection"}},"title":""},"wafUpdateDdosSettingsResponse":{"type":"object","properties":{"ddosSettings":{"$ref":"#/components/schemas/wafDdosSettings"}},"description":"A response from a request to update a WAF site's DDOS protection settings"},"wafUpdatePolicyGroupsRequest":{"type":"object","properties":{"policyGroups":{"type":"array","items":{"$ref":"#/components/schemas/wafPolicyGroup"},"description":"A site's WAF policy groups"}},"title":""},"wafUpdateRuleRequest":{"type":"object","properties":{"name":{"type":"string","description":"The WAF rule's name"},"description":{"type":"string","description":"A rule's description"},"conditions":{"type":"array","items":{"$ref":"#/components/schemas/RuleCondition"},"description":"The conditions required for a WAF rule to trigger"},"actionValue":{"$ref":"#/components/schemas/wafRuleAction"},"enabled":{"type":"boolean","format":"boolean","description":"Whether or not the rule should be enabled"},"statusCode":{"$ref":"#/components/schemas/wafRuleStatusCode"},"actionDuration":{"type":"string","description":"How long a rule's block action will apply to subsequent requests\n\nDurations only apply to rules with block actions."}},"title":""},"wafUpdateRuleResponse":{"type":"object","properties":{"rule":{"$ref":"#/components/schemas/wafRule"}},"description":"The results from a request to update a WAF rule"},"wafUpdateSiteApiUrlsRequest":{"type":"object","properties":{"apiUrls":{"type":"array","items":{"type":"string"},"description":"A list of API URLs that will be processed differently by the WAF"}},"title":""},"wafUpdateSiteApiUrlsResponse":{"type":"object","properties":{"apiUrls":{"type":"array","items":{"type":"string"},"description":"A list of API URLs that will be processed differently by the WAF"}},"description":"A response from a request to update an WAF site's API URLs"},"wafVerificationRequirements":{"type":"object","properties":{"dnsVerificationDetails":{"$ref":"#/components/schemas/wafDnsVerificationDetails"},"httpVerificationDetails":{"$ref":"#/components/schemas/wafHttpVerificationDetails"},"verificationMethod":{"$ref":"#/components/schemas/wafCertificateVerificationMethod"}},"description":"Conditions that must be met to verify ownership of a domain for SSL certificate provisioning"},"wafWAFOrganization":{"type":"object","properties":{"name":{"type":"string","description":"An organization's name"}},"description":"A WHOIS organization"}}}}